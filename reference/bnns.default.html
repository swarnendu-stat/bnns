<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Bayesian Neural Network Model Using Formula(default) Interface — bnns.default • bnns</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bayesian Neural Network Model Using Formula(default) Interface — bnns.default"><meta name="description" content="Fits a Bayesian Neural Network (BNN) model using a formula interface. The function parses the formula and data to create the input feature matrix and target vector, then fits the model using bnns.default."><meta property="og:description" content="Fits a Bayesian Neural Network (BNN) model using a formula interface. The function parses the formula and data to create the input feature matrix and target vector, then fits the model using bnns.default."><meta property="og:image" content="https://swarnendu-stat.github.io/bnns/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">bnns</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/bnns.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/benchmarking.html">Benchmarking bnns</a></li>
    <li><a class="dropdown-item" href="../articles/common_applications.html">Common Application Areas of bnns</a></li>
    <li><a class="dropdown-item" href="../articles/ct_app.html">Using Bayesian Neural Networks in Clinical Trials</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/swarnendu-stat/bnns/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Bayesian Neural Network Model Using Formula(default) Interface</h1>
      <small class="dont-index">Source: <a href="https://github.com/swarnendu-stat/bnns/blob/master/R/bnns.R" class="external-link"><code>R/bnns.R</code></a></small>
      <div class="d-none name"><code>bnns.default.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Fits a Bayesian Neural Network (BNN) model using a formula interface. The function parses the formula and data to create the input feature matrix and target vector, then fits the model using <code>bnns.default</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># Default S3 method</span></span>
<span><span class="fu"><a href="bnns.html">bnns</a></span><span class="op">(</span></span>
<span>  <span class="va">formula</span>,</span>
<span>  data <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  L <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  nodes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="va">L</span><span class="op">)</span>,</span>
<span>  act_fn <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">2</span>, <span class="va">L</span><span class="op">)</span>,</span>
<span>  out_act_fn <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">1000</span>,</span>
<span>  warmup <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  thin <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  cores <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">123</span>,</span>
<span>  prior_weights <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prior_bias <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  prior_sigma <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  refresh <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">iter</span><span class="op">/</span><span class="fl">10</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  normalize <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>A symbolic description of the model to be fitted. The formula should specify the response variable and predictors (e.g., <code>y ~ x1 + x2</code>).</p></dd>


<dt id="arg-data">data<a class="anchor" aria-label="anchor" href="#arg-data"></a></dt>
<dd><p>A data frame or list containing the variables in the model. Default is an empty list.</p></dd>


<dt id="arg-l">L<a class="anchor" aria-label="anchor" href="#arg-l"></a></dt>
<dd><p>An integer specifying the number of hidden layers in the neural network. Default is 1.</p></dd>


<dt id="arg-nodes">nodes<a class="anchor" aria-label="anchor" href="#arg-nodes"></a></dt>
<dd><p>An integer or vector specifying the number of nodes in each hidden layer. If a single value is provided, it is applied to all layers. Default is 16.</p></dd>


<dt id="arg-act-fn">act_fn<a class="anchor" aria-label="anchor" href="#arg-act-fn"></a></dt>
<dd><p>An integer or vector specifying the activation function(s) for the hidden layers. Options are:</p><ul><li><p><code>1</code> for tanh</p></li>
<li><p><code>2</code> for sigmoid (default)</p></li>
<li><p><code>3</code> for softplus</p></li>
<li><p><code>4</code> for ReLU</p></li>
<li><p><code>5</code> for linear</p></li>
</ul></dd>


<dt id="arg-out-act-fn">out_act_fn<a class="anchor" aria-label="anchor" href="#arg-out-act-fn"></a></dt>
<dd><p>An integer specifying the activation function for the output layer. Options are:</p><ul><li><p><code>1</code> for linear (default)</p></li>
<li><p><code>2</code> for sigmoid</p></li>
<li><p><code>3</code> for softmax</p></li>
</ul></dd>


<dt id="arg-iter">iter<a class="anchor" aria-label="anchor" href="#arg-iter"></a></dt>
<dd><p>An integer specifying the total number of iterations for the Stan sampler. Default is <code>1e3</code>.</p></dd>


<dt id="arg-warmup">warmup<a class="anchor" aria-label="anchor" href="#arg-warmup"></a></dt>
<dd><p>An integer specifying the number of warmup iterations for the Stan sampler. Default is <code>2e2</code>.</p></dd>


<dt id="arg-thin">thin<a class="anchor" aria-label="anchor" href="#arg-thin"></a></dt>
<dd><p>An integer specifying the thinning interval for Stan samples. Default is 1.</p></dd>


<dt id="arg-chains">chains<a class="anchor" aria-label="anchor" href="#arg-chains"></a></dt>
<dd><p>An integer specifying the number of Markov chains. Default is 2.</p></dd>


<dt id="arg-cores">cores<a class="anchor" aria-label="anchor" href="#arg-cores"></a></dt>
<dd><p>An integer specifying the number of CPU cores to use for parallel sampling. Default is 2.</p></dd>


<dt id="arg-seed">seed<a class="anchor" aria-label="anchor" href="#arg-seed"></a></dt>
<dd><p>An integer specifying the random seed for reproducibility. Default is 123.</p></dd>


<dt id="arg-prior-weights">prior_weights<a class="anchor" aria-label="anchor" href="#arg-prior-weights"></a></dt>
<dd><p>A list specifying the prior distribution for the weights in the neural network.
The list must include two components:</p><ul><li><p><code>dist</code>: A character string specifying the distribution type. Supported values are
<code>"normal"</code>, <code>"uniform"</code>, and <code>"cauchy"</code>.</p></li>
<li><p><code>params</code>: A named list specifying the parameters for the chosen distribution:</p><ul><li><p>For <code>"normal"</code>: Provide <code>mean</code> (mean of the distribution) and <code>sd</code> (standard deviation).</p></li>
<li><p>For <code>"uniform"</code>: Provide <code>alpha</code> (lower bound) and <code>beta</code> (upper bound).</p></li>
<li><p>For <code>"cauchy"</code>: Provide <code>mu</code> (location parameter) and <code>sigma</code> (scale parameter).</p></li>
</ul></li>
</ul><p>If <code>prior_weights</code> is <code>NULL</code>, the default prior is a <code>normal(0, 1)</code> distribution.
For example:</p><ul><li><p><code>list(dist = "normal", params = list(mean = 0, sd = 1))</code></p></li>
<li><p><code>list(dist = "uniform", params = list(alpha = -1, beta = 1))</code></p></li>
<li><p><code>list(dist = "cauchy", params = list(mu = 0, sigma = 2.5))</code></p></li>
</ul></dd>


<dt id="arg-prior-bias">prior_bias<a class="anchor" aria-label="anchor" href="#arg-prior-bias"></a></dt>
<dd><p>A list specifying the prior distribution for the biases in the neural network.
The list must include two components:</p><ul><li><p><code>dist</code>: A character string specifying the distribution type. Supported values are
<code>"normal"</code>, <code>"uniform"</code>, and <code>"cauchy"</code>.</p></li>
<li><p><code>params</code>: A named list specifying the parameters for the chosen distribution:</p><ul><li><p>For <code>"normal"</code>: Provide <code>mean</code> (mean of the distribution) and <code>sd</code> (standard deviation).</p></li>
<li><p>For <code>"uniform"</code>: Provide <code>alpha</code> (lower bound) and <code>beta</code> (upper bound).</p></li>
<li><p>For <code>"cauchy"</code>: Provide <code>mu</code> (location parameter) and <code>sigma</code> (scale parameter).</p></li>
</ul></li>
</ul><p>If <code>prior_bias</code> is <code>NULL</code>, the default prior is a <code>normal(0, 1)</code> distribution.
For example:</p><ul><li><p><code>list(dist = "normal", params = list(mean = 0, sd = 1))</code></p></li>
<li><p><code>list(dist = "uniform", params = list(alpha = -1, beta = 1))</code></p></li>
<li><p><code>list(dist = "cauchy", params = list(mu = 0, sigma = 2.5))</code></p></li>
</ul></dd>


<dt id="arg-prior-sigma">prior_sigma<a class="anchor" aria-label="anchor" href="#arg-prior-sigma"></a></dt>
<dd><p>A list specifying the prior distribution for the <code>sigma</code> parameter in regression
models (<code>out_act_fn = 1</code>). This allows for setting priors on the standard deviation of the residuals.
The list must include two components:</p><ul><li><p><code>dist</code>: A character string specifying the distribution type. Supported values are
<code>"half-normal"</code> and <code>"inverse-gamma"</code>.</p></li>
<li><p><code>params</code>: A named list specifying the parameters for the chosen distribution:</p><ul><li><p>For <code>"half-normal"</code>: Provide <code>sd</code> (standard deviation of the half-normal distribution).</p></li>
<li><p>For <code>"inverse-gamma"</code>: Provide <code>shape</code> (shape parameter) and <code>scale</code> (scale parameter).</p></li>
</ul></li>
</ul><p>If <code>prior_sigma</code> is <code>NULL</code>, the default prior is a <code>half-normal(0, 1)</code> distribution.
For example:</p><ul><li><p><code>list(dist = "half_normal", params = list(mean = 0, sd = 1))</code></p></li>
<li><p><code>list(dist = "inv_gamma", params = list(alpha = 1, beta = 1))</code></p></li>
</ul></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>TRUE or FALSE: flag indicating whether to print intermediate output from Stan on the console, which might be helpful for model debugging.</p></dd>


<dt id="arg-refresh">refresh<a class="anchor" aria-label="anchor" href="#arg-refresh"></a></dt>
<dd><p>refresh (integer) can be used to control how often the progress of the sampling is reported (i.e. show the progress every refresh iterations). By default, refresh = max(iter/10, 1). The progress indicator is turned off if refresh &lt;= 0.</p></dd>


<dt id="arg-normalize">normalize<a class="anchor" aria-label="anchor" href="#arg-normalize"></a></dt>
<dd><p>Logical. If <code>TRUE</code> (default), the input predictors
are normalized to have zero mean and unit variance before training.
Normalization ensures stable and efficient Bayesian sampling by standardizing
the input scale, which is particularly beneficial for neural network training.
If <code>FALSE</code>, no normalization is applied, and it is assumed that the input data
is already pre-processed appropriately.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Currently not in use.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>"bnns"</code> containing the fitted model and associated information, including:</p><ul><li><p><code>fit</code>: The fitted Stan model object.</p></li>
<li><p><code>data</code>: A list containing the processed training data.</p></li>
<li><p><code>call</code>: The matched function call.</p></li>
<li><p><code>formula</code>: The formula used for the model.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function uses the provided formula and data to generate the design matrix for the predictors and the response vector. It then calls helper function bnns_train to fit the Bayesian Neural Network model.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example usage with formula interface:</span></span></span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, x2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span>, y <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="bnns.html">bnns</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="op">-</span><span class="fl">1</span> <span class="op">+</span> <span class="va">x1</span> <span class="op">+</span> <span class="va">x2</span>,</span></span>
<span class="r-in"><span>  data <span class="op">=</span> <span class="va">data</span>, L <span class="op">=</span> <span class="fl">1</span>, nodes <span class="op">=</span> <span class="fl">2</span>, act_fn <span class="op">=</span> <span class="fl">3</span>,</span></span>
<span class="r-in"><span>  iter <span class="op">=</span> <span class="fl">1e2</span>, warmup <span class="op">=</span> <span class="fl">5e1</span>, chains <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> SAMPLING FOR MODEL 'anon_model' NOW (CHAIN 1).</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Gradient evaluation took 1.7e-05 seconds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: 1000 transitions using 10 leapfrog steps per transition would take 0.17 seconds.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Adjust your expectations accordingly!</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: WARNING: There aren't enough warmup iterations to fit the</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:          three stages of adaptation as currently configured.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:          Reducing each adaptation stage to 15%/75%/10% of</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:          the given number of warmup iterations:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:            init_buffer = 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:            adapt_window = 38</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:            term_buffer = 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration:  1 / 100 [  1%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 10 / 100 [ 10%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 20 / 100 [ 20%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 30 / 100 [ 30%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 40 / 100 [ 40%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 50 / 100 [ 50%]  (Warmup)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 51 / 100 [ 51%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 60 / 100 [ 60%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 70 / 100 [ 70%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 80 / 100 [ 80%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 90 / 100 [ 90%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: Iteration: 100 / 100 [100%]  (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:  Elapsed Time: 0.005 seconds (Warm-up)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:                0.006 seconds (Sampling)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1:                0.011 seconds (Total)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Chain 1: </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Swarnendu Chatterjee.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

